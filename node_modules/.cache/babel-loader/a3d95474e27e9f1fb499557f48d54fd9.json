{"ast":null,"code":"var _jsxFileName = \"/Users/vu/Documents/Work/Repositories/co2/src/components/section/viz/PolarPlot.js\";\nimport React, { Component } from 'react';\nimport './PolarPlot.scss';\nimport { select, scaleLinear, extent, min, axisBottom, axisRight, lineRadial, easeQuad, easeQuadOut, easeCubicOut } from 'd3';\n\nclass PolarPlot extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      vizCreated: false,\n      currentState: -1,\n      updateFunc: null\n    };\n    this.createViz = this.createViz.bind(this);\n    this.vizRef = React.createRef();\n  }\n\n  createViz(data) {\n    let margin = 40,\n        radius = Math.min(window.innerWidth - 440, window.innerHeight - 200),\n        innerRadius = radius - margin,\n        grandDaddy = select('#polar-plot'),\n        svg = grandDaddy.select('.viz-svg-wrap').append('svg').attr('width', radius).attr('height', radius).attr('class', 'viz'),\n        a = scaleLinear().domain([0, 365.25]).range([0, 2 * Math.PI]).nice(),\n        r = scaleLinear().domain(extent(data, (d, i) => {\n      return d.level;\n    })).range([0, innerRadius / 2]).nice(),\n        totalLength = null,\n        minDate = min(data, function (d) {\n      return d.date;\n    }),\n        xDays = data.map(d => Math.floor((d.date.getTime() - minDate.getTime()) / (1000 * 60 * 60 * 24) % 365.25)); // // Grid lines\n    // svg.append('g')\n    //   .attr('class', 'y grid')\n    //   .attr('transform', 'translate(' + margin.left + ', ' + height + ')')\n    //   .call(axisBottom(x)\n    //       .ticks(5)\n    //       .tickSize(-radius)\n    //       .tickFormat('')\n    //   )\n    // grandDaddy.selectAll('.y.grid>.tick').each(function(d, i) {\n    //   select(this).attr(\"stroke-dasharray\", height + \" \" + height)\n    //     .attr(\"stroke-dashoffset\", height)\n    //     .transition()\n    //       .duration(800)\n    //       .ease(easeCubicOut)\n    //       .attr('stroke-dashoffset', function() {\n    //         if (i%2 === 0) {\n    //           return 0\n    //         } else {\n    //           return 2*height\n    //         }\n    //       })\n    // })\n    // svg.append('g')\n    //   .attr('class', 'x grid')\n    //   .attr('transform', 'translate(' + margin.left + ', ' + margin.top + ')')\n    //   .call(axisRight(y)\n    //       .ticks(5)\n    //       .tickSize(width)\n    //       .tickFormat('')\n    //   )\n    // grandDaddy.selectAll('.x.grid>.tick').each(function(d, i) {\n    //   select(this).attr(\"stroke-dasharray\", width + \" \" + width)\n    //     .attr(\"stroke-dashoffset\", width)\n    //     .transition()\n    //       .duration(800)\n    //       .ease(easeCubicOut)\n    //       .attr('stroke-dashoffset', function() {\n    //         if (i%2 === 0) {\n    //           return 0\n    //         } else {\n    //           return 2*width\n    //         }\n    //       })\n    // })\n    // Axes\n    // svg.append('g')\n    //   .attr('class', 'x axis')\n    //   .attr('transform', 'translate(' + margin.left + ', ' + (innerHeight + margin.top) + ')')\n    //   .style(\"opacity\", 0)\n    //   .transition()\n    //     .duration(800)\n    //     .ease(easeQuad)\n    //     .style('opacity', 1)\n    //   .call(axisBottom(x)\n    //     .ticks(5)\n    //     .tickSize(0)\n    //     .tickPadding(24))\n    // svg.append('g')\n    //   .attr('class', 'y axis')\n    //   .attr('transform', 'translate(' + (innerWidth + margin.left) + ', ' + margin.top + ')')\n    //   .style(\"opacity\", 0)\n    //   .transition()\n    //     .duration(800)\n    //     .ease(easeQuad)\n    //     .style('opacity', 1)\n    //   .call(axisRight(y)\n    //     .ticks(5)\n    //     .tickSize(0)\n    //     .tickPadding(32))\n    // svg.append('line')\n    //   .attr('class', 'bottom-axis')\n    //   .attr(\"x1\", 0)\n    //   .attr(\"y1\", height - margin.bottom)\n    //   .attr(\"x2\", width)\n    //   .attr(\"y2\", height - margin.bottom)\n    //   .style(\"opacity\", 0)\n    //   .transition()\n    //     .duration(800)\n    //     .ease(easeQuadOut)\n    //     .style('opacity', 1)\n    // let dataLine = svg.append('path')\n    //   .datum(data)\n    //   .attr('class', 'data-line')\n    //   .attr('transform', 'translate(' + (radius/2) + ' ' + (radius/2) + ')')\n    //   .attr('d', lineRadial()\n    //     .angle(function(_, index) { return a(xDays[index]) + margin })\n    //     .radius(function(d) { return r(d.level) + margin })\n    //   ),\n\n    let rGrid = svg.append('g').attr('class', 'r axis').attr('transform', 'translate(' + radius / 2 + ' ' + radius / 2 + ')');\n    rGrid.selectAll('circle').data(r.ticks(5)).enter().append('circle').attr('class', 'grid-circle').attr('r', r);\n    rGrid.selectAll('text').data(r.ticks(5)).enter().append('text').attr('class', 'r tick').attr('text-anchor', 'middle').attr('dy', function (d) {\n      return -r(d) - 10;\n    }).text(function (d) {\n      return d;\n    });\n    console.log(a(a.ticks(12)[1])); //     ,\n    // labels = rGrid.append(\"text\")\n    //     .attr(\"text-anchor\", \"middle\")\n    //     // .attr(\"y\", function(d) { return -r(d); })\n    //     // .attr(\"dy\", \"0.35em\")\n    //     .attr(\"stroke\", \"#000\")\n    //     .text(function(d) { return d });\n    // rTick.append(\"text\")\n    //         .attr(\"y\", function(d) { return r(d); })\n    //         .attr(\"dy\", \"0.35em\")\n    //         .text(function(d) { return \"$\" + d; });\n    // rAxis.append(\"circle\")\n    //   \t\t.attr(\"fill\", \"none\")\n    //      .attr(\"stroke\", \"black\")\n    //   \t\t.attr(\"opacity\", 0.2)\n    //      .attr(\"r\", function() { return r(r.domain()[0])});\n    // Animate data line\n    // totalLength = dataLine.node().getTotalLength()\n    // dataLine.attr(\"stroke-dasharray\", totalLength + \" \" + totalLength)\n    //   .attr(\"stroke-dashoffset\", totalLength)\n    //   .transition()\n    //     .duration(1600)\n    //     .ease(easeQuadOut)\n    //     .attr('stroke-dashoffset', 0)\n\n    this.setState({\n      vizCreated: true,\n      updateFunc: (to, from) => {\n        let regLineLength = null,\n            yReg = null,\n            newText = to !== -1 ? this.vizRef.current.querySelector('.viz-des-text:nth-child(' + (to + 1) + ')') : null;\n\n        if (to > from) {\n          if (newText) {\n            newText.classList.add('on');\n          }\n\n          let increment = target => {\n            switch (target) {\n              case 0:\n                // Initial\n                // Main data line\n                let dataLine = svg.append('path').datum(data).attr('class', 'data-line').attr('d', lineRadial().x(function () {\n                  return a(xDays) + margin;\n                }).y(function (d) {\n                  return r(d.level) + margin;\n                })); // Animate data line\n\n                totalLength = dataLine.node().getTotalLength();\n                dataLine.attr(\"stroke-dasharray\", totalLength + \" \" + totalLength).attr(\"stroke-dashoffset\", totalLength).transition().duration(800).ease(easeCubicOut).attr('stroke-dashoffset', 0);\n                break;\n              //       case 1: // Linear\n              //         yReg = xDays.map(d => this.props.content[1].params[0] + this.props.content[1].params[1]*d)\n              //         let regLine = svg.append('path')\n              //           .datum(data)\n              //           .attr('class', 'reg-line')\n              //           .attr('d', line()\n              //             .x(function(d) { return x(d.date) + margin.left })\n              //             .y(function(d, i) {return y(yReg[i]) + margin.top })\n              //         ),\n              //         regLineLabel = svg.append('g')\n              //           .attr('class', 'reg-line-label')\n              //           .attr('transform',\n              //             'translate('\n              //             + (x(data[Math.ceil(data.length*0.52)]['date']) + margin.left + 60)\n              //             + ', '\n              //             + (y(yReg[Math.ceil(yReg.length*0.52)]) + margin.top + 20)\n              //             + ')'\n              //           )\n              //         grandDaddy.select('.bottom-axis').raise()\n              //         regLineLabel.style('opacity', 0)\n              //           .transition()\n              //             .duration(720)\n              //             .ease(easeQuad)\n              //             .style('opacity', 1)\n              //         regLineLabel.append('rect')\n              //           .attr('class', 'reg-line-label-rect linear')\n              //           .attr('rx', 4)\n              //           .attr('ry', 4)\n              //           .style('width', '4.6em')\n              //         let regLineLabelText = regLineLabel.append('text')\n              //             .attr('class', 'reg-line-label-text')\n              //         regLineLabelText.append('tspan')\n              //             .attr('class', 'linear span')\n              //             .text('y = αx')\n              //         regLineLength = regLine.node().getTotalLength()\n              //         regLine.attr(\"stroke-dasharray\", regLineLength + \" \" + regLineLength)\n              //           .attr(\"stroke-dashoffset\", regLineLength)\n              //           .transition()\n              //             .duration(800)\n              //             .ease(easeCubicOut)\n              //             .attr('stroke-dashoffset', 0)\n              //         grandDaddy.select('.data-line').attr('class', 'data-line faded')\n              //         grandDaddy.selectAll('.reg-line-label-text>tspan:not(.linear)')\n              //           .each(function(d) {\n              //             let currentSpan = select(this)\n              //             if (!currentSpan.node().classList.contains('off')) {\n              //               currentSpan.node().classList.add('off')\n              //             }\n              //           })\n              //         break\n              //       case 2: // Quadratic\n              //         yReg = xDays.map(d => this.props.content[2].params[0] + this.props.content[2].params[1]*d + this.props.content[2].params[2]*d**2)\n              //         grandDaddy.select('.reg-line').transition()\n              //           .duration(800)\n              //           .ease(easeCubicOut)\n              //           .attr('d', line()\n              //             .x(function(d) { return x(d.date) + margin.left })\n              //             .y(function(d, i) {return y(yReg[i]) + margin.top })\n              //           )\n              //         regLineLength = grandDaddy.select('.reg-line').node().getTotalLength()\n              //         grandDaddy.select('.reg-line').attr(\"stroke-dasharray\", 0)\n              //           .attr('stroke-dashoffset', 0)\n              //         grandDaddy.select('.reg-line-label-rect')\n              //           .attr('class', 'reg-line-label-rect quadratic')\n              //           .transition()\n              //             .duration(600)\n              //             .ease(easeCubicOut)\n              //             .style('width', '7.7em')\n              //         grandDaddy.select('.reg-line-label-text').append('tspan')\n              //           .attr('class', 'quadratic span')\n              //           .text(' + βx\\u00b2')\n              //           .style('opacity', 0)\n              //             .transition()\n              //               .duration(800)\n              //               .ease(easeQuad)\n              //               .style('opacity', 1)\n              //         grandDaddy.selectAll('.reg-line-label-text>tspan:not(.quadratic)')\n              //           .each(function(d) {\n              //             let currentSpan = select(this)\n              //             if (!currentSpan.node().classList.contains('off')) {\n              //               currentSpan.node().classList.add('off')\n              //             }\n              //           })\n              //         break\n              //       case 3: // Cosine\n              //         yReg = xDays.map(d => this.props.content[3].params[0]\n              //           + this.props.content[3].params[1]*d\n              //           + this.props.content[3].params[2]*d**2\n              //           + this.props.content[3].params[3]*Math.cos(2*Math.PI*d/365.25 + this.props.content[3].params[4])\n              //         )\n              //         grandDaddy.select('.reg-line').attr(\"stroke-dasharray\", regLineLength + \" \" + regLineLength)\n              //           .transition()\n              //             .duration(800)\n              //             .ease(easeCubicOut)\n              //             .attr('d', line()\n              //               .x(function(d) { return x(d.date) + margin.left })\n              //               .y(function(d, i) {return y(yReg[i]) + margin.top })\n              //           )\n              //         regLineLength = grandDaddy.select('.reg-line').node().getTotalLength()\n              //         grandDaddy.select('.reg-line').attr(\"stroke-dasharray\", 0)\n              //           .attr('stroke-dashoffset', 0)\n              //         grandDaddy.select('.reg-line-label-rect')\n              //           .attr('class', 'reg-line-label-rect cosine')\n              //           .transition()\n              //             .duration(600)\n              //             .ease(easeCubicOut)\n              //             .style('width', '15.6em')\n              //         grandDaddy.select('.reg-line-label-text').append('tspan')\n              //           .attr('class', 'cosine span')\n              //           .text(' + cos(2πt + φ)')\n              //           .style('opacity', 0)\n              //             .transition()\n              //               .duration(800)\n              //               .ease(easeQuad)\n              //               .style('opacity', 1)\n              //         grandDaddy.selectAll('.reg-line-label-text>tspan:not(.cosine)')\n              //           .each(function(d) {\n              //             let currentSpan = select(this)\n              //             if (!currentSpan.node().classList.contains('off')) {\n              //               currentSpan.node().classList.add('off')\n              //             }\n              //           })\n              //         break\n              //       default:\n              //     }\n              //   }\n              //   for (let i = from; i < to; i++) {\n              //     let prevText = this.vizRef.current.querySelector('.viz-des-text:nth-child(' + (i + 1) + ')')\n              //     increment(i + 1)\n              //     if (prevText) {\n              //       prevText.classList.remove('on')\n              //       prevText.classList.remove('on-reverse')\n              //     }\n              //   }\n              // } else if (to < from) {\n              //   if (newText) {\n              //     newText.classList.add('on-reverse')\n              //   }\n              //   let decrement = (target) => {\n              //     console.log(target)\n              //     switch(target) {\n              //       case -1:\n              //         let dataLineLength = grandDaddy.select('.data-line').node().getTotalLength()\n              //         grandDaddy.select('.data-line').attr('stroke-dashoffset', 0)\n              //           .transition()\n              //             .duration(800)\n              //             .ease(easeCubicOut)\n              //             .attr('stroke-dashoffset', -dataLineLength)\n              //             .remove()\n              //         break\n              //       case 0: // Initial\n              //         regLineLength = grandDaddy.select('.reg-line').node().getTotalLength()\n              //         grandDaddy.select('.reg-line').attr('stroke-dashoffset', 0)\n              //           .transition()\n              //             .duration(800)\n              //             .ease(easeCubicOut)\n              //             .attr('stroke-dashoffset', -regLineLength)\n              //             .remove()\n              //         grandDaddy.select('.data-line').attr('class', 'data-line')\n              //         grandDaddy.select('.reg-line-label').style('opacity', 1)\n              //           .transition()\n              //             .duration(800)\n              //             .ease(easeCubicOut)\n              //             .style('opacity', 0)\n              //             .remove()\n              //         break\n              //       case 1: // Linear\n              //         yReg = xDays.map(d => this.props.content[1].params[0] + this.props.content[1].params[1]*d)\n              //         grandDaddy.select('.reg-line').transition()\n              //           .duration(800)\n              //           .ease(easeCubicOut)\n              //           .attr('d', line()\n              //             .x(function(d) { return x(d.date) + margin.left })\n              //             .y(function(d, i) {return y(yReg[i]) + margin.top })\n              //         )\n              //         regLineLength = grandDaddy.select('.reg-line').node().getTotalLength()\n              //         grandDaddy.select('.reg-line').attr(\"stroke-dasharray\", regLineLength + \" \" + regLineLength)\n              //         grandDaddy.select('.reg-line-label-text>.quadratic.span').style('opacity', 1)\n              //           .transition()\n              //             .duration(320)\n              //             .ease(easeCubicOut)\n              //             .style('opacity', 0)\n              //             .remove()\n              //         grandDaddy.select('.reg-line-label-rect').attr('class', 'reg-line-label-rect linear')\n              //           .transition()\n              //             .duration(600)\n              //             .ease(easeCubicOut)\n              //             .style('width', '4.6em')\n              //         setTimeout(() => {\n              //           grandDaddy.select('.reg-line-label-rect').attr('class', 'reg-line-label-rect linear')\n              //         })\n              //         grandDaddy.select('.reg-line-label-text>.linear.span').attr('class', 'linear span on')\n              //         break\n              //       case 2: // Quadratic\n              //         yReg = xDays.map(d => this.props.content[2].params[0]\n              //           + this.props.content[2].params[1]*d\n              //           + this.props.content[2].params[2]*d**2)\n              //         grandDaddy.select('.reg-line').transition()\n              //           .duration(800)\n              //           .ease(easeCubicOut)\n              //           .attr('d', line()\n              //             .x(function(d) { return x(d.date) + margin.left })\n              //             .y(function(d, i) {return y(yReg[i]) + margin.top })\n              //         )\n              //         regLineLength = grandDaddy.select('.reg-line').node().getTotalLength()\n              //         grandDaddy.select('.reg-line').attr(\"stroke-dasharray\", regLineLength + \" \" + regLineLength)\n              //         grandDaddy.select('.reg-line-label-text>.cosine.span').style('opacity', 1)\n              //           .transition()\n              //             .duration(320)\n              //             .ease(easeCubicOut)\n              //             .style('opacity', 0)\n              //             .remove()\n              //         grandDaddy.select('.reg-line-label-rect').attr('class', 'reg-line-label-rect quadratic')\n              //           .transition()\n              //             .duration(600)\n              //             .ease(easeCubicOut)\n              //             .style('width', '7.7em')\n              //         setTimeout(() => {\n              //           grandDaddy.select('.reg-line-label-rect').attr('class', 'reg-line-label-rect quadratic')\n              //         })\n              //         grandDaddy.select('.reg-line-label-text>.quadratic.span').attr('class', 'quadratic span on')\n              //         break\n\n              default:\n            }\n          };\n\n          for (let i = from; i > to; i--) {\n            let prevText = this.vizRef.current.querySelector('.viz-des-text:nth-child(' + (i + 1) + ')');\n            increment(i - 1);\n\n            if (prevText) {\n              prevText.classList.remove('on');\n              prevText.classList.remove('on-reverse');\n            }\n          }\n        }\n\n        this.setState({\n          currentState: to\n        });\n      }\n    });\n  }\n\n  componentDidMount() {\n    this.createViz(this.props.data); // let vizObserver = new IntersectionObserver(\n    //   (entries, observer) => {\n    //     if (entries[0].isIntersecting && !this.state.vizCreated) {\n    //       this.setState({\n    //         vizCreated: true\n    //       }, () => {\n    //         this.createViz(this.props.data)\n    //       })\n    //     }\n    //   },\n    //   {\n    //     rootMargin: '0 0 -70%',\n    //     threshold: 0\n    //   })\n    // vizObserver.observe(this.vizRef.current)\n    //\n    // let vizScrollObserver = new IntersectionObserver(\n    //   (entries, observer) => {\n    //     entries.forEach((entry) => {\n    //       if (entry.isIntersecting) {\n    //         let index = entry.target.dataset.index\n    //         if (!this.state.vizCreated) {\n    //           this.createViz(this.props.data)\n    //         }\n    //         this.state.updateFunc(Number(index), this.state.currentState)\n    //       }\n    //     })\n    //   },\n    //   {\n    //     threshold: 0\n    //   }\n    // )\n    // document.querySelectorAll('.viz-scroll-anchor').forEach(el => {\n    //   vizScrollObserver.observe(el)\n    // })\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      id: \"polar-plot\",\n      className: \"viz-outer-wrap\",\n      ref: this.vizRef,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 495\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"viz-scroll-box\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 496\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"viz-scroll-anchor\",\n      \"data-index\": \"-1\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 497\n      },\n      __self: this\n    }), this.props.content.map((_, index) => {\n      return React.createElement(\"div\", {\n        className: \"viz-scroll-anchor\",\n        \"data-index\": index,\n        key: index,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 500\n        },\n        __self: this\n      });\n    }), React.createElement(\"div\", {\n      className: \"viz-scroll-dummy-anchor\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 503\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"viz-wrap\",\n      id: \"line-chart\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 505\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"viz-svg-wrap\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 506\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"viz-des-wrap\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 507\n      },\n      __self: this\n    }, this.props.content.map((chunk, index) => {\n      return React.createElement(\"p\", {\n        className: \"viz-des-text\",\n        key: index,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 510\n        },\n        __self: this\n      }, chunk.des);\n    }))));\n  }\n\n}\n\nexport default PolarPlot;","map":{"version":3,"sources":["/Users/vu/Documents/Work/Repositories/co2/src/components/section/viz/PolarPlot.js"],"names":["React","Component","select","scaleLinear","extent","min","axisBottom","axisRight","lineRadial","easeQuad","easeQuadOut","easeCubicOut","PolarPlot","constructor","props","state","vizCreated","currentState","updateFunc","createViz","bind","vizRef","createRef","data","margin","radius","Math","window","innerWidth","innerHeight","innerRadius","grandDaddy","svg","append","attr","a","domain","range","PI","nice","r","d","i","level","totalLength","minDate","date","xDays","map","floor","getTime","rGrid","selectAll","ticks","enter","text","console","log","setState","to","from","regLineLength","yReg","newText","current","querySelector","classList","add","increment","target","dataLine","datum","x","y","node","getTotalLength","transition","duration","ease","prevText","remove","componentDidMount","render","content","_","index","chunk","des"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAO,kBAAP;AACA,SAASC,MAAT,EACEC,WADF,EAEEC,MAFF,EAGEC,GAHF,EAIEC,UAJF,EAIcC,SAJd,EAKEC,UALF,EAMEC,QANF,EAOEC,WAPF,EAQEC,YARF,QASQ,IATR;;AAWA,MAAMC,SAAN,SAAwBX,SAAxB,CAAkC;AAChCY,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACjB,UAAMA,KAAN;AACA,SAAKC,KAAL,GAAa;AACXC,MAAAA,UAAU,EAAE,KADD;AAEXC,MAAAA,YAAY,EAAE,CAAC,CAFJ;AAGXC,MAAAA,UAAU,EAAE;AAHD,KAAb;AAKA,SAAKC,SAAL,GAAiB,KAAKA,SAAL,CAAeC,IAAf,CAAoB,IAApB,CAAjB;AACA,SAAKC,MAAL,GAAcrB,KAAK,CAACsB,SAAN,EAAd;AACD;;AACDH,EAAAA,SAAS,CAACI,IAAD,EAAO;AACd,QAAIC,MAAM,GAAG,EAAb;AAAA,QACEC,MAAM,GAAGC,IAAI,CAACrB,GAAL,CAASsB,MAAM,CAACC,UAAP,GAAoB,GAA7B,EAAkCD,MAAM,CAACE,WAAP,GAAqB,GAAvD,CADX;AAAA,QAEEC,WAAW,GAAGL,MAAM,GAAGD,MAFzB;AAAA,QAGEO,UAAU,GAAG7B,MAAM,CAAC,aAAD,CAHrB;AAAA,QAIE8B,GAAG,GAAGD,UAAU,CAAC7B,MAAX,CAAkB,eAAlB,EACL+B,MADK,CACE,KADF,EAEHC,IAFG,CAEE,OAFF,EAEWT,MAFX,EAGHS,IAHG,CAGE,QAHF,EAGYT,MAHZ,EAIHS,IAJG,CAIE,OAJF,EAIW,KAJX,CAJR;AAAA,QASEC,CAAC,GAAGhC,WAAW,GACdiC,MADG,CACI,CAAC,CAAD,EAAI,MAAJ,CADJ,EAEHC,KAFG,CAEG,CAAC,CAAD,EAAI,IAAEX,IAAI,CAACY,EAAX,CAFH,EAGHC,IAHG,EATN;AAAA,QAaEC,CAAC,GAAGrC,WAAW,GACdiC,MADG,CACIhC,MAAM,CAACmB,IAAD,EAAO,CAACkB,CAAD,EAAIC,CAAJ,KAAU;AAAC,aAAOD,CAAC,CAACE,KAAT;AAAe,KAAjC,CADV,EAEHN,KAFG,CAEG,CAAC,CAAD,EAAIP,WAAW,GAAC,CAAhB,CAFH,EAGHS,IAHG,EAbN;AAAA,QAiBEK,WAAW,GAAG,IAjBhB;AAAA,QAkBEC,OAAO,GAAGxC,GAAG,CAACkB,IAAD,EAAO,UAASkB,CAAT,EAAY;AAAC,aAAOA,CAAC,CAACK,IAAT;AAAc,KAAlC,CAlBf;AAAA,QAmBEC,KAAK,GAAGxB,IAAI,CAACyB,GAAL,CAASP,CAAC,IAAIf,IAAI,CAACuB,KAAL,CAAW,CAACR,CAAC,CAACK,IAAF,CAAOI,OAAP,KAAmBL,OAAO,CAACK,OAAR,EAApB,KAAwC,OAAK,EAAL,GAAQ,EAAR,GAAW,EAAnD,IAAyD,MAApE,CAAd,CAnBV,CADc,CAsBd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACE,QAAIC,KAAK,GAAGnB,GAAG,CAACC,MAAJ,CAAW,GAAX,EACTC,IADS,CACJ,OADI,EACK,QADL,EAETA,IAFS,CAEJ,WAFI,EAES,eAAgBT,MAAM,GAAC,CAAvB,GAA4B,GAA5B,GAAmCA,MAAM,GAAC,CAA1C,GAA+C,GAFxD,CAAZ;AAIA0B,IAAAA,KAAK,CAACC,SAAN,CAAgB,QAAhB,EACG7B,IADH,CACQiB,CAAC,CAACa,KAAF,CAAQ,CAAR,CADR,EAEGC,KAFH,GAGGrB,MAHH,CAGU,QAHV,EAIKC,IAJL,CAIU,OAJV,EAImB,aAJnB,EAKKA,IALL,CAKU,GALV,EAKeM,CALf;AAOAW,IAAAA,KAAK,CAACC,SAAN,CAAgB,MAAhB,EACG7B,IADH,CACQiB,CAAC,CAACa,KAAF,CAAQ,CAAR,CADR,EAEGC,KAFH,GAGGrB,MAHH,CAGU,MAHV,EAIKC,IAJL,CAIU,OAJV,EAImB,QAJnB,EAKKA,IALL,CAKU,aALV,EAKyB,QALzB,EAMKA,IANL,CAMU,IANV,EAMgB,UAASO,CAAT,EAAY;AAAC,aAAO,CAACD,CAAC,CAACC,CAAD,CAAF,GAAQ,EAAf;AAAkB,KAN/C,EAOKc,IAPL,CAOU,UAAUd,CAAV,EAAa;AAAC,aAAOA,CAAP;AAAS,KAPjC;AASAe,IAAAA,OAAO,CAACC,GAAR,CAAYtB,CAAC,CAACA,CAAC,CAACkB,KAAF,CAAQ,EAAR,EAAY,CAAZ,CAAD,CAAb,EApIY,CAqIZ;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACD;AACA;AACA;AACA;AACA;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,SAAKK,QAAL,CAAc;AACZ1C,MAAAA,UAAU,EAAE,IADA;AAEZE,MAAAA,UAAU,EAAE,CAACyC,EAAD,EAAKC,IAAL,KAAc;AACxB,YAAIC,aAAa,GAAG,IAApB;AAAA,YACEC,IAAI,GAAG,IADT;AAAA,YAEEC,OAAO,GAAGJ,EAAE,KAAK,CAAC,CAAR,GAAY,KAAKtC,MAAL,CAAY2C,OAAZ,CAAoBC,aAApB,CAAkC,8BAA8BN,EAAE,GAAG,CAAnC,IAAwC,GAA1E,CAAZ,GAA6F,IAFzG;;AAGA,YAAIA,EAAE,GAAGC,IAAT,EAAe;AACb,cAAIG,OAAJ,EAAa;AACXA,YAAAA,OAAO,CAACG,SAAR,CAAkBC,GAAlB,CAAsB,IAAtB;AACD;;AACD,cAAIC,SAAS,GAAIC,MAAD,IAAY;AAC1B,oBAAOA,MAAP;AACE,mBAAK,CAAL;AAAQ;AACN;AACA,oBAAIC,QAAQ,GAAGtC,GAAG,CAACC,MAAJ,CAAW,MAAX,EACZsC,KADY,CACNhD,IADM,EAEZW,IAFY,CAEP,OAFO,EAEE,WAFF,EAGZA,IAHY,CAGP,GAHO,EAGF1B,UAAU,GAClBgE,CADQ,CACN,YAAW;AAAE,yBAAOrC,CAAC,CAACY,KAAD,CAAD,GAAWvB,MAAlB;AAA0B,iBADjC,EAERiD,CAFQ,CAEN,UAAShC,CAAT,EAAY;AAAE,yBAAOD,CAAC,CAACC,CAAC,CAACE,KAAH,CAAD,GAAanB,MAApB;AAA4B,iBAFpC,CAHE,CAAf,CAFF,CAUE;;AACAoB,gBAAAA,WAAW,GAAG0B,QAAQ,CAACI,IAAT,GAAgBC,cAAhB,EAAd;AACAL,gBAAAA,QAAQ,CAACpC,IAAT,CAAc,kBAAd,EAAkCU,WAAW,GAAG,GAAd,GAAoBA,WAAtD,EACGV,IADH,CACQ,mBADR,EAC6BU,WAD7B,EAEGgC,UAFH,GAGKC,QAHL,CAGc,GAHd,EAIKC,IAJL,CAIUnE,YAJV,EAKKuB,IALL,CAKU,mBALV,EAK+B,CAL/B;AAMA;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACM;AAlPF;AAoPD,WArPD;;AAsPA,eAAK,IAAIQ,CAAC,GAAGkB,IAAb,EAAmBlB,CAAC,GAAGiB,EAAvB,EAA2BjB,CAAC,EAA5B,EAAgC;AAC9B,gBAAIqC,QAAQ,GAAG,KAAK1D,MAAL,CAAY2C,OAAZ,CAAoBC,aAApB,CAAkC,8BAA8BvB,CAAC,GAAG,CAAlC,IAAuC,GAAzE,CAAf;AACA0B,YAAAA,SAAS,CAAC1B,CAAC,GAAG,CAAL,CAAT;;AACA,gBAAIqC,QAAJ,EAAc;AACZA,cAAAA,QAAQ,CAACb,SAAT,CAAmBc,MAAnB,CAA0B,IAA1B;AACAD,cAAAA,QAAQ,CAACb,SAAT,CAAmBc,MAAnB,CAA0B,YAA1B;AACD;AACF;AACF;;AACD,aAAKtB,QAAL,CAAc;AACZzC,UAAAA,YAAY,EAAE0C;AADF,SAAd;AAGD;AA5QW,KAAd;AA8QD;;AACDsB,EAAAA,iBAAiB,GAAG;AAClB,SAAK9D,SAAL,CAAe,KAAKL,KAAL,CAAWS,IAA1B,EADkB,CAElB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACD;;AACD2D,EAAAA,MAAM,GAAG;AACP,WACE;AAAK,MAAA,EAAE,EAAC,YAAR;AAAqB,MAAA,SAAS,EAAC,gBAA/B;AAAgD,MAAA,GAAG,EAAE,KAAK7D,MAA1D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAK,MAAA,SAAS,EAAC,gBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAK,MAAA,SAAS,EAAC,mBAAf;AAAmC,oBAAW,IAA9C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,EAEG,KAAKP,KAAL,CAAWqE,OAAX,CAAmBnC,GAAnB,CAAuB,CAACoC,CAAD,EAAIC,KAAJ,KAAc;AACpC,aACE;AAAK,QAAA,SAAS,EAAC,mBAAf;AAAmC,sBAAYA,KAA/C;AAAsD,QAAA,GAAG,EAAEA,KAA3D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF;AAGD,KAJA,CAFH,EAOE;AAAK,MAAA,SAAS,EAAC,yBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAPF,CADF,EAUE;AAAK,MAAA,SAAS,EAAC,UAAf;AAA0B,MAAA,EAAE,EAAC,YAA7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAK,MAAA,SAAS,EAAC,cAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,EAEE;AAAK,MAAA,SAAS,EAAC,cAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACG,KAAKvE,KAAL,CAAWqE,OAAX,CAAmBnC,GAAnB,CAAuB,CAACsC,KAAD,EAAQD,KAAR,KAAkB;AACxC,aACE;AAAG,QAAA,SAAS,EAAC,cAAb;AAA4B,QAAA,GAAG,EAAEA,KAAjC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAyCC,KAAK,CAACC,GAA/C,CADF;AAGD,KAJA,CADH,CAFF,CAVF,CADF;AAuBD;;AAvf+B;;AA0flC,eAAe3E,SAAf","sourcesContent":["import React, { Component } from 'react';\nimport './PolarPlot.scss';\nimport { select,\n  scaleLinear,\n  extent,\n  min,\n  axisBottom, axisRight,\n  lineRadial,\n  easeQuad,\n  easeQuadOut,\n  easeCubicOut\n } from 'd3';\n\nclass PolarPlot extends Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      vizCreated: false,\n      currentState: -1,\n      updateFunc: null\n    }\n    this.createViz = this.createViz.bind(this)\n    this.vizRef = React.createRef()\n  }\n  createViz(data) {\n    let margin = 40,\n      radius = Math.min(window.innerWidth - 440, window.innerHeight - 200),\n      innerRadius = radius - margin,\n      grandDaddy = select('#polar-plot'),\n      svg = grandDaddy.select('.viz-svg-wrap')\n      .append('svg')\n        .attr('width', radius)\n        .attr('height', radius)\n        .attr('class', 'viz'),\n      a = scaleLinear()\n      .domain([0, 365.25])\n      .range([0, 2*Math.PI])\n      .nice(),\n      r = scaleLinear()\n      .domain(extent(data, (d, i) => {return d.level}))\n      .range([0, innerRadius/2])\n      .nice(),\n      totalLength = null,\n      minDate = min(data, function(d) {return d.date}),\n      xDays = data.map(d => Math.floor((d.date.getTime() - minDate.getTime())/(1000*60*60*24) % 365.25))\n\n    // // Grid lines\n    // svg.append('g')\n    //   .attr('class', 'y grid')\n    //   .attr('transform', 'translate(' + margin.left + ', ' + height + ')')\n    //   .call(axisBottom(x)\n    //       .ticks(5)\n    //       .tickSize(-radius)\n    //       .tickFormat('')\n    //   )\n    // grandDaddy.selectAll('.y.grid>.tick').each(function(d, i) {\n    //   select(this).attr(\"stroke-dasharray\", height + \" \" + height)\n    //     .attr(\"stroke-dashoffset\", height)\n    //     .transition()\n    //       .duration(800)\n    //       .ease(easeCubicOut)\n    //       .attr('stroke-dashoffset', function() {\n    //         if (i%2 === 0) {\n    //           return 0\n    //         } else {\n    //           return 2*height\n    //         }\n    //       })\n    // })\n    // svg.append('g')\n    //   .attr('class', 'x grid')\n    //   .attr('transform', 'translate(' + margin.left + ', ' + margin.top + ')')\n    //   .call(axisRight(y)\n    //       .ticks(5)\n    //       .tickSize(width)\n    //       .tickFormat('')\n    //   )\n    // grandDaddy.selectAll('.x.grid>.tick').each(function(d, i) {\n    //   select(this).attr(\"stroke-dasharray\", width + \" \" + width)\n    //     .attr(\"stroke-dashoffset\", width)\n    //     .transition()\n    //       .duration(800)\n    //       .ease(easeCubicOut)\n    //       .attr('stroke-dashoffset', function() {\n    //         if (i%2 === 0) {\n    //           return 0\n    //         } else {\n    //           return 2*width\n    //         }\n    //       })\n    // })\n\n    // Axes\n    // svg.append('g')\n    //   .attr('class', 'x axis')\n    //   .attr('transform', 'translate(' + margin.left + ', ' + (innerHeight + margin.top) + ')')\n    //   .style(\"opacity\", 0)\n    //   .transition()\n    //     .duration(800)\n    //     .ease(easeQuad)\n    //     .style('opacity', 1)\n    //   .call(axisBottom(x)\n    //     .ticks(5)\n    //     .tickSize(0)\n    //     .tickPadding(24))\n    // svg.append('g')\n    //   .attr('class', 'y axis')\n    //   .attr('transform', 'translate(' + (innerWidth + margin.left) + ', ' + margin.top + ')')\n    //   .style(\"opacity\", 0)\n    //   .transition()\n    //     .duration(800)\n    //     .ease(easeQuad)\n    //     .style('opacity', 1)\n    //   .call(axisRight(y)\n    //     .ticks(5)\n    //     .tickSize(0)\n    //     .tickPadding(32))\n    // svg.append('line')\n    //   .attr('class', 'bottom-axis')\n    //   .attr(\"x1\", 0)\n    //   .attr(\"y1\", height - margin.bottom)\n    //   .attr(\"x2\", width)\n    //   .attr(\"y2\", height - margin.bottom)\n    //   .style(\"opacity\", 0)\n    //   .transition()\n    //     .duration(800)\n    //     .ease(easeQuadOut)\n    //     .style('opacity', 1)\n    // let dataLine = svg.append('path')\n    //   .datum(data)\n    //   .attr('class', 'data-line')\n    //   .attr('transform', 'translate(' + (radius/2) + ' ' + (radius/2) + ')')\n    //   .attr('d', lineRadial()\n    //     .angle(function(_, index) { return a(xDays[index]) + margin })\n    //     .radius(function(d) { return r(d.level) + margin })\n    //   ),\n      let rGrid = svg.append('g')\n        .attr('class', 'r axis')\n        .attr('transform', 'translate(' + (radius/2) + ' ' + (radius/2) + ')')\n\n      rGrid.selectAll('circle')\n        .data(r.ticks(5))\n        .enter()\n        .append('circle')\n          .attr('class', 'grid-circle')\n          .attr('r', r)\n\n      rGrid.selectAll('text')\n        .data(r.ticks(5))\n        .enter()\n        .append('text')\n          .attr('class', 'r tick')\n          .attr('text-anchor', 'middle')\n          .attr('dy', function(d) {return -r(d) - 10})\n          .text(function (d) {return d})\n\n      console.log(a(a.ticks(12)[1]))\n      //     ,\n      // labels = rGrid.append(\"text\")\n      //     .attr(\"text-anchor\", \"middle\")\n      //     // .attr(\"y\", function(d) { return -r(d); })\n      //     // .attr(\"dy\", \"0.35em\")\n      //     .attr(\"stroke\", \"#000\")\n      //     .text(function(d) { return d });\n\n      // rTick.append(\"text\")\n      //         .attr(\"y\", function(d) { return r(d); })\n      //         .attr(\"dy\", \"0.35em\")\n      //         .text(function(d) { return \"$\" + d; });\n     // rAxis.append(\"circle\")\n     //   \t\t.attr(\"fill\", \"none\")\n     //      .attr(\"stroke\", \"black\")\n     //   \t\t.attr(\"opacity\", 0.2)\n     //      .attr(\"r\", function() { return r(r.domain()[0])});\n\n    // Animate data line\n    // totalLength = dataLine.node().getTotalLength()\n    // dataLine.attr(\"stroke-dasharray\", totalLength + \" \" + totalLength)\n    //   .attr(\"stroke-dashoffset\", totalLength)\n    //   .transition()\n    //     .duration(1600)\n    //     .ease(easeQuadOut)\n    //     .attr('stroke-dashoffset', 0)\n    this.setState({\n      vizCreated: true,\n      updateFunc: (to, from) => {\n        let regLineLength = null,\n          yReg = null,\n          newText = to !== -1 ? this.vizRef.current.querySelector('.viz-des-text:nth-child(' + (to + 1) + ')') : null\n        if (to > from) {\n          if (newText) {\n            newText.classList.add('on')\n          }\n          let increment = (target) => {\n            switch(target) {\n              case 0: // Initial\n                // Main data line\n                let dataLine = svg.append('path')\n                  .datum(data)\n                  .attr('class', 'data-line')\n                  .attr('d', lineRadial()\n                    .x(function() { return a(xDays) + margin })\n                    .y(function(d) { return r(d.level) + margin })\n                  )\n\n                // Animate data line\n                totalLength = dataLine.node().getTotalLength()\n                dataLine.attr(\"stroke-dasharray\", totalLength + \" \" + totalLength)\n                  .attr(\"stroke-dashoffset\", totalLength)\n                  .transition()\n                    .duration(800)\n                    .ease(easeCubicOut)\n                    .attr('stroke-dashoffset', 0)\n                break\n        //       case 1: // Linear\n        //         yReg = xDays.map(d => this.props.content[1].params[0] + this.props.content[1].params[1]*d)\n        //         let regLine = svg.append('path')\n        //           .datum(data)\n        //           .attr('class', 'reg-line')\n        //           .attr('d', line()\n        //             .x(function(d) { return x(d.date) + margin.left })\n        //             .y(function(d, i) {return y(yReg[i]) + margin.top })\n        //         ),\n        //         regLineLabel = svg.append('g')\n        //           .attr('class', 'reg-line-label')\n        //           .attr('transform',\n        //             'translate('\n        //             + (x(data[Math.ceil(data.length*0.52)]['date']) + margin.left + 60)\n        //             + ', '\n        //             + (y(yReg[Math.ceil(yReg.length*0.52)]) + margin.top + 20)\n        //             + ')'\n        //           )\n        //         grandDaddy.select('.bottom-axis').raise()\n        //         regLineLabel.style('opacity', 0)\n        //           .transition()\n        //             .duration(720)\n        //             .ease(easeQuad)\n        //             .style('opacity', 1)\n        //         regLineLabel.append('rect')\n        //           .attr('class', 'reg-line-label-rect linear')\n        //           .attr('rx', 4)\n        //           .attr('ry', 4)\n        //           .style('width', '4.6em')\n        //         let regLineLabelText = regLineLabel.append('text')\n        //             .attr('class', 'reg-line-label-text')\n        //         regLineLabelText.append('tspan')\n        //             .attr('class', 'linear span')\n        //             .text('y = αx')\n        //         regLineLength = regLine.node().getTotalLength()\n        //         regLine.attr(\"stroke-dasharray\", regLineLength + \" \" + regLineLength)\n        //           .attr(\"stroke-dashoffset\", regLineLength)\n        //           .transition()\n        //             .duration(800)\n        //             .ease(easeCubicOut)\n        //             .attr('stroke-dashoffset', 0)\n        //         grandDaddy.select('.data-line').attr('class', 'data-line faded')\n        //         grandDaddy.selectAll('.reg-line-label-text>tspan:not(.linear)')\n        //           .each(function(d) {\n        //             let currentSpan = select(this)\n        //             if (!currentSpan.node().classList.contains('off')) {\n        //               currentSpan.node().classList.add('off')\n        //             }\n        //           })\n        //         break\n        //       case 2: // Quadratic\n        //         yReg = xDays.map(d => this.props.content[2].params[0] + this.props.content[2].params[1]*d + this.props.content[2].params[2]*d**2)\n        //         grandDaddy.select('.reg-line').transition()\n        //           .duration(800)\n        //           .ease(easeCubicOut)\n        //           .attr('d', line()\n        //             .x(function(d) { return x(d.date) + margin.left })\n        //             .y(function(d, i) {return y(yReg[i]) + margin.top })\n        //           )\n        //         regLineLength = grandDaddy.select('.reg-line').node().getTotalLength()\n        //         grandDaddy.select('.reg-line').attr(\"stroke-dasharray\", 0)\n        //           .attr('stroke-dashoffset', 0)\n        //         grandDaddy.select('.reg-line-label-rect')\n        //           .attr('class', 'reg-line-label-rect quadratic')\n        //           .transition()\n        //             .duration(600)\n        //             .ease(easeCubicOut)\n        //             .style('width', '7.7em')\n        //         grandDaddy.select('.reg-line-label-text').append('tspan')\n        //           .attr('class', 'quadratic span')\n        //           .text(' + βx\\u00b2')\n        //           .style('opacity', 0)\n        //             .transition()\n        //               .duration(800)\n        //               .ease(easeQuad)\n        //               .style('opacity', 1)\n        //         grandDaddy.selectAll('.reg-line-label-text>tspan:not(.quadratic)')\n        //           .each(function(d) {\n        //             let currentSpan = select(this)\n        //             if (!currentSpan.node().classList.contains('off')) {\n        //               currentSpan.node().classList.add('off')\n        //             }\n        //           })\n        //         break\n        //       case 3: // Cosine\n        //         yReg = xDays.map(d => this.props.content[3].params[0]\n        //           + this.props.content[3].params[1]*d\n        //           + this.props.content[3].params[2]*d**2\n        //           + this.props.content[3].params[3]*Math.cos(2*Math.PI*d/365.25 + this.props.content[3].params[4])\n        //         )\n        //         grandDaddy.select('.reg-line').attr(\"stroke-dasharray\", regLineLength + \" \" + regLineLength)\n        //           .transition()\n        //             .duration(800)\n        //             .ease(easeCubicOut)\n        //             .attr('d', line()\n        //               .x(function(d) { return x(d.date) + margin.left })\n        //               .y(function(d, i) {return y(yReg[i]) + margin.top })\n        //           )\n        //         regLineLength = grandDaddy.select('.reg-line').node().getTotalLength()\n        //         grandDaddy.select('.reg-line').attr(\"stroke-dasharray\", 0)\n        //           .attr('stroke-dashoffset', 0)\n        //         grandDaddy.select('.reg-line-label-rect')\n        //           .attr('class', 'reg-line-label-rect cosine')\n        //           .transition()\n        //             .duration(600)\n        //             .ease(easeCubicOut)\n        //             .style('width', '15.6em')\n        //         grandDaddy.select('.reg-line-label-text').append('tspan')\n        //           .attr('class', 'cosine span')\n        //           .text(' + cos(2πt + φ)')\n        //           .style('opacity', 0)\n        //             .transition()\n        //               .duration(800)\n        //               .ease(easeQuad)\n        //               .style('opacity', 1)\n        //         grandDaddy.selectAll('.reg-line-label-text>tspan:not(.cosine)')\n        //           .each(function(d) {\n        //             let currentSpan = select(this)\n        //             if (!currentSpan.node().classList.contains('off')) {\n        //               currentSpan.node().classList.add('off')\n        //             }\n        //           })\n        //         break\n        //       default:\n        //     }\n        //   }\n        //   for (let i = from; i < to; i++) {\n        //     let prevText = this.vizRef.current.querySelector('.viz-des-text:nth-child(' + (i + 1) + ')')\n        //     increment(i + 1)\n        //     if (prevText) {\n        //       prevText.classList.remove('on')\n        //       prevText.classList.remove('on-reverse')\n        //     }\n        //   }\n        // } else if (to < from) {\n        //   if (newText) {\n        //     newText.classList.add('on-reverse')\n        //   }\n        //   let decrement = (target) => {\n        //     console.log(target)\n        //     switch(target) {\n        //       case -1:\n        //         let dataLineLength = grandDaddy.select('.data-line').node().getTotalLength()\n        //         grandDaddy.select('.data-line').attr('stroke-dashoffset', 0)\n        //           .transition()\n        //             .duration(800)\n        //             .ease(easeCubicOut)\n        //             .attr('stroke-dashoffset', -dataLineLength)\n        //             .remove()\n        //         break\n        //       case 0: // Initial\n        //         regLineLength = grandDaddy.select('.reg-line').node().getTotalLength()\n        //         grandDaddy.select('.reg-line').attr('stroke-dashoffset', 0)\n        //           .transition()\n        //             .duration(800)\n        //             .ease(easeCubicOut)\n        //             .attr('stroke-dashoffset', -regLineLength)\n        //             .remove()\n        //         grandDaddy.select('.data-line').attr('class', 'data-line')\n        //         grandDaddy.select('.reg-line-label').style('opacity', 1)\n        //           .transition()\n        //             .duration(800)\n        //             .ease(easeCubicOut)\n        //             .style('opacity', 0)\n        //             .remove()\n        //         break\n        //       case 1: // Linear\n        //         yReg = xDays.map(d => this.props.content[1].params[0] + this.props.content[1].params[1]*d)\n        //         grandDaddy.select('.reg-line').transition()\n        //           .duration(800)\n        //           .ease(easeCubicOut)\n        //           .attr('d', line()\n        //             .x(function(d) { return x(d.date) + margin.left })\n        //             .y(function(d, i) {return y(yReg[i]) + margin.top })\n        //         )\n        //         regLineLength = grandDaddy.select('.reg-line').node().getTotalLength()\n        //         grandDaddy.select('.reg-line').attr(\"stroke-dasharray\", regLineLength + \" \" + regLineLength)\n        //         grandDaddy.select('.reg-line-label-text>.quadratic.span').style('opacity', 1)\n        //           .transition()\n        //             .duration(320)\n        //             .ease(easeCubicOut)\n        //             .style('opacity', 0)\n        //             .remove()\n        //         grandDaddy.select('.reg-line-label-rect').attr('class', 'reg-line-label-rect linear')\n        //           .transition()\n        //             .duration(600)\n        //             .ease(easeCubicOut)\n        //             .style('width', '4.6em')\n        //         setTimeout(() => {\n        //           grandDaddy.select('.reg-line-label-rect').attr('class', 'reg-line-label-rect linear')\n        //         })\n        //         grandDaddy.select('.reg-line-label-text>.linear.span').attr('class', 'linear span on')\n        //         break\n        //       case 2: // Quadratic\n        //         yReg = xDays.map(d => this.props.content[2].params[0]\n        //           + this.props.content[2].params[1]*d\n        //           + this.props.content[2].params[2]*d**2)\n        //         grandDaddy.select('.reg-line').transition()\n        //           .duration(800)\n        //           .ease(easeCubicOut)\n        //           .attr('d', line()\n        //             .x(function(d) { return x(d.date) + margin.left })\n        //             .y(function(d, i) {return y(yReg[i]) + margin.top })\n        //         )\n        //         regLineLength = grandDaddy.select('.reg-line').node().getTotalLength()\n        //         grandDaddy.select('.reg-line').attr(\"stroke-dasharray\", regLineLength + \" \" + regLineLength)\n        //         grandDaddy.select('.reg-line-label-text>.cosine.span').style('opacity', 1)\n        //           .transition()\n        //             .duration(320)\n        //             .ease(easeCubicOut)\n        //             .style('opacity', 0)\n        //             .remove()\n        //         grandDaddy.select('.reg-line-label-rect').attr('class', 'reg-line-label-rect quadratic')\n        //           .transition()\n        //             .duration(600)\n        //             .ease(easeCubicOut)\n        //             .style('width', '7.7em')\n        //         setTimeout(() => {\n        //           grandDaddy.select('.reg-line-label-rect').attr('class', 'reg-line-label-rect quadratic')\n        //         })\n        //         grandDaddy.select('.reg-line-label-text>.quadratic.span').attr('class', 'quadratic span on')\n        //         break\n              default:\n            }\n          }\n          for (let i = from; i > to; i--) {\n            let prevText = this.vizRef.current.querySelector('.viz-des-text:nth-child(' + (i + 1) + ')')\n            increment(i - 1)\n            if (prevText) {\n              prevText.classList.remove('on')\n              prevText.classList.remove('on-reverse')\n            }\n          }\n        }\n        this.setState({\n          currentState: to\n        })\n      }\n    })\n  }\n  componentDidMount() {\n    this.createViz(this.props.data)\n    // let vizObserver = new IntersectionObserver(\n    //   (entries, observer) => {\n    //     if (entries[0].isIntersecting && !this.state.vizCreated) {\n    //       this.setState({\n    //         vizCreated: true\n    //       }, () => {\n    //         this.createViz(this.props.data)\n    //       })\n    //     }\n    //   },\n    //   {\n    //     rootMargin: '0 0 -70%',\n    //     threshold: 0\n    //   })\n    // vizObserver.observe(this.vizRef.current)\n    //\n    // let vizScrollObserver = new IntersectionObserver(\n    //   (entries, observer) => {\n    //     entries.forEach((entry) => {\n    //       if (entry.isIntersecting) {\n    //         let index = entry.target.dataset.index\n    //         if (!this.state.vizCreated) {\n    //           this.createViz(this.props.data)\n    //         }\n    //         this.state.updateFunc(Number(index), this.state.currentState)\n    //       }\n    //     })\n    //   },\n    //   {\n    //     threshold: 0\n    //   }\n    // )\n    // document.querySelectorAll('.viz-scroll-anchor').forEach(el => {\n    //   vizScrollObserver.observe(el)\n    // })\n  }\n  render() {\n    return (\n      <div id=\"polar-plot\" className=\"viz-outer-wrap\" ref={this.vizRef}>\n        <div className=\"viz-scroll-box\">\n          <div className=\"viz-scroll-anchor\" data-index=\"-1\"></div>\n          {this.props.content.map((_, index) => {\n            return (\n              <div className=\"viz-scroll-anchor\" data-index={index} key={index}></div>\n            )\n          })}\n          <div className=\"viz-scroll-dummy-anchor\"></div>\n        </div>\n        <div className=\"viz-wrap\" id=\"line-chart\">\n          <div className=\"viz-svg-wrap\"></div>\n          <div className=\"viz-des-wrap\">\n            {this.props.content.map((chunk, index) => {\n              return (\n                <p className=\"viz-des-text\" key={index}>{chunk.des}</p>\n              )\n            })}\n          </div>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default PolarPlot;\n"]},"metadata":{},"sourceType":"module"}