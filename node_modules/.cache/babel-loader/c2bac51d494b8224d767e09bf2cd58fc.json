{"ast":null,"code":"var _jsxFileName = \"/Users/vu/Documents/Work/Repositories/co2/src/components/section/viz/LineChart.js\";\nimport React, { Component } from 'react';\nimport './LineChart.css';\nimport { select, scaleLinear, scaleTime, line, transition } from 'd3';\n\nclass LineChart extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      vizCreated: false,\n      currentState: -1,\n      updateFunc: null\n    };\n    this.createViz = this.createViz.bind(this);\n    this.vizRef = React.createRef();\n  }\n\n  createViz(data) {\n    let margin = {\n      top: 20,\n      right: 60,\n      bottom: 40,\n      left: 0\n    },\n        width = Math.min(window.innerWidth - 440, 1200),\n        height = Math.min(window.innerHeight - 200, width),\n        innerWidth = width - margin.left - margin.right,\n        innerHeight = height - margin.top - margin.bottom,\n        svg = scale.scaleTimeselect('#line-chart>.viz-svg-wrap').append('svg').attr('width', width).attr('height', height).attr('class', 'viz'),\n        x = scale.scaleTimescaleTime().domain(scale.scaleTimeextent(data, (d, i) => {\n      return d.date;\n    })).range([0, innerWidth]).nice(),\n        y = scale.scaleTimescaleLinear().domain(scale.scaleTimeextent(data, (d, i) => {\n      return d.level;\n    })).range([innerHeight, 0]).nice(),\n        totalLength = null; // Grid lines\n\n    svg.append('g').attr('class', 'y grid').attr('transform', 'translate(' + margin.left + ', ' + height + ')').call(scale.scaleTimeaxisBottom(x).ticks(5).tickSize(-height).tickFormat(''));\n    scale.scaleTimeselectAll('.y.grid>.tick').each(function (d, i) {\n      scale.scaleTimeselect(this).attr(\"stroke-dasharray\", height + \" \" + height).attr(\"stroke-dashoffset\", height).transition().duration(800).ease(scale.scaleTimeeaseCubicOut).attr('stroke-dashoffset', function () {\n        if (i % 2 === 0) {\n          return 0;\n        } else {\n          return 2 * height;\n        }\n      });\n    });\n    svg.append('g').attr('class', 'x grid').attr('transform', 'translate(' + margin.left + ', ' + margin.top + ')').call(scale.scaleTimeaxisLeft(y).ticks(5).tickSize(-width).tickFormat(''));\n    scale.scaleTimeselectAll('.x.grid>.tick').each(function (d, i) {\n      scale.scaleTimeselect(this).attr(\"stroke-dasharray\", width + \" \" + width).attr(\"stroke-dashoffset\", width).transition().duration(800).ease(scale.scaleTimeeaseCubicOut).attr('stroke-dashoffset', function () {\n        if (i % 2 === 0) {\n          return 0;\n        } else {\n          return 2 * width;\n        }\n      });\n    }); // Axes\n\n    svg.append('g').attr('class', 'x axis').attr('transform', 'translate(' + margin.left + ', ' + (innerHeight + margin.top) + ')').style(\"opacity\", 0).transition().duration(800).ease(scale.scaleTimeeaseQuad).style('opacity', 1).call(scale.scaleTimeaxisBottom(x).ticks(5).tickSize(0).tickPadding(24));\n    svg.append('g').attr('class', 'y axis').attr('transform', 'translate(' + (innerWidth + margin.left) + ', ' + margin.top + ')').style(\"opacity\", 0).transition().duration(800).ease(scale.scaleTimeeaseQuad).style('opacity', 1).call(scale.scaleTimeaxisRight(y).ticks(5).tickSize(0).tickPadding(32));\n    svg.append('line').attr('class', 'bottom-axis').attr(\"x1\", 0).attr(\"y1\", height - margin.bottom).attr(\"x2\", width).attr(\"y2\", height - margin.bottom).style(\"opacity\", 0).transition().duration(800).ease(scale.scaleTimeeaseQuadOut).style('opacity', 1);\n    this.setState({\n      vizCreated: true,\n      updateFunc: (to, from) => {\n        let regLineLength = null,\n            minDate = scale.scaleTimemin(data, function (d) {\n          return d.date;\n        }),\n            xDays = data.map(d => Math.ceil((d.date.getTime() - minDate.getTime()) / (1000 * 60 * 60 * 24))),\n            yReg = null,\n            newText = this.vizRef.current.querySelector('.viz-des-text:nth-child(' + (to + 1) + ')');\n\n        if (to > from) {\n          newText.classList.add('on');\n\n          let increment = target => {\n            switch (target) {\n              case 0:\n                // Initial\n                // Main data line\n                let dataLine = svg.append('path').datum(data).attr('class', 'data-line').attr('d', scale.scaleTimeline().x(function (d) {\n                  return x(d.date) + margin.left;\n                }).y(function (d) {\n                  return y(d.level) + margin.top;\n                })); // Animate data line\n\n                totalLength = dataLine.node().getTotalLength();\n                dataLine.attr(\"stroke-dasharray\", totalLength + \" \" + totalLength).attr(\"stroke-dashoffset\", totalLength).transition().duration(800).ease(scale.scaleTimeeaseCubicOut).attr('stroke-dashoffset', 0);\n                break;\n\n              case 1:\n                // Linear\n                yReg = xDays.map(d => this.props.content[1].params[0] + this.props.content[1].params[1] * d);\n                let regLine = svg.append('path').datum(data).attr('class', 'reg-line').attr('d', scale.scaleTimeline().x(function (d) {\n                  return x(d.date) + margin.left;\n                }).y(function (d, i) {\n                  return y(yReg[i]) + margin.top;\n                })),\n                    regLineLabel = svg.append('g').attr('class', 'reg-line-label').attr('transform', 'translate(' + (x(data[Math.ceil(data.length * 0.52)]['date']) + margin.left + 60) + ', ' + (y(yReg[Math.ceil(yReg.length * 0.52)]) + margin.top + 20) + ')');\n                regLineLabel.style('opacity', 0).transition().duration(720).ease(scale.scaleTimeeaseQuad).style('opacity', 1);\n                regLineLabel.append('rect').attr('class', 'reg-line-label-rect linear').attr('rx', 4).attr('ry', 4).style('width', '4.6em');\n                let regLineLabelText = regLineLabel.append('text').attr('class', 'reg-line-label-text');\n                regLineLabelText.append('tspan').attr('class', 'linear span').text('y = αx');\n                regLineLength = regLine.node().getTotalLength();\n                regLine.attr(\"stroke-dasharray\", regLineLength + \" \" + regLineLength).attr(\"stroke-dashoffset\", regLineLength).transition().duration(800).ease(scale.scaleTimeeaseCubicOut).attr('stroke-dashoffset', 0);\n                scale.scaleTimeselect('.data-line').attr('class', 'data-line faded');\n                scale.scaleTimeselectAll('.reg-line-label-text>tspan:not(.linear)').each(function (d) {\n                  let currentSpan = scale.scaleTimeselect(this);\n\n                  if (!currentSpan.node().classList.contains('off')) {\n                    currentSpan.node().classList.add('off');\n                  }\n                });\n                break;\n\n              case 2:\n                // Quadratic\n                yReg = xDays.map(d => this.props.content[2].params[0] + this.props.content[2].params[1] * d + this.props.content[2].params[2] * d ** 2);\n                scale.scaleTimeselect('.reg-line').transition().duration(800).ease(scale.scaleTimeeaseCubicOut).attr('d', scale.scaleTimeline().x(function (d) {\n                  return x(d.date) + margin.left;\n                }).y(function (d, i) {\n                  return y(yReg[i]) + margin.top;\n                }));\n                regLineLength = scale.scaleTimeselect('.reg-line').node().getTotalLength();\n                scale.scaleTimeselect('.reg-line').attr(\"stroke-dasharray\", 0).attr('stroke-dashoffset', 0);\n                scale.scaleTimeselect('.reg-line-label-rect').attr('class', 'reg-line-label-rect quadratic').transition().duration(600).ease(scale.scaleTimeeaseCubicOut).style('width', '7.7em');\n                scale.scaleTimeselect('.reg-line-label-text').append('tspan').attr('class', 'quadratic span').text(' + βx\\u00b2').style('opacity', 0).transition().duration(800).ease(scale.scaleTimeeaseQuad).style('opacity', 1);\n                scale.scaleTimeselectAll('.reg-line-label-text>tspan:not(.quadratic)').each(function (d) {\n                  let currentSpan = scale.scaleTimeselect(this);\n\n                  if (!currentSpan.node().classList.contains('off')) {\n                    currentSpan.node().classList.add('off');\n                  }\n                });\n                break;\n\n              case 3:\n                // Cosine\n                yReg = xDays.map(d => this.props.content[3].params[0] + this.props.content[3].params[1] * d + this.props.content[3].params[2] * d ** 2 + this.props.content[3].params[3] * Math.cos(2 * Math.PI * d / 365.25 + this.props.content[3].params[4]));\n                scale.scaleTimeselect('.reg-line').attr(\"stroke-dasharray\", regLineLength + \" \" + regLineLength).transition().duration(800).ease(scale.scaleTimeeaseCubicOut).attr('d', scale.scaleTimeline().x(function (d) {\n                  return x(d.date) + margin.left;\n                }).y(function (d, i) {\n                  return y(yReg[i]) + margin.top;\n                }));\n                regLineLength = scale.scaleTimeselect('.reg-line').node().getTotalLength();\n                scale.scaleTimeselect('.reg-line').attr(\"stroke-dasharray\", 0).attr('stroke-dashoffset', 0);\n                scale.scaleTimeselect('.reg-line-label-rect').attr('class', 'reg-line-label-rect cosine').transition().duration(600).ease(scale.scaleTimeeaseCubicOut).style('width', '15.6em');\n                scale.scaleTimeselect('.reg-line-label-text').append('tspan').attr('class', 'cosine span').text(' + cos(2πt + φ)').style('opacity', 0).transition().duration(800).ease(scale.scaleTimeeaseQuad).style('opacity', 1);\n                scale.scaleTimeselectAll('.reg-line-label-text>tspan:not(.cosine)').each(function (d) {\n                  let currentSpan = scale.scaleTimeselect(this);\n\n                  if (!currentSpan.node().classList.contains('off')) {\n                    currentSpan.node().classList.add('off');\n                  }\n                });\n                break;\n\n              default:\n            }\n          };\n\n          for (let i = from; i < to; i++) {\n            let prevText = this.vizRef.current.querySelector('.viz-des-text:nth-child(' + (i + 1) + ')');\n            increment(i + 1);\n\n            if (prevText) {\n              prevText.classList.remove('on');\n              prevText.classList.remove('on-reverse');\n            }\n          }\n        } else if (to < from) {\n          newText.classList.add('on-reverse');\n\n          let decrement = target => {\n            switch (target) {\n              case 0:\n                // Initial\n                regLineLength = scale.scaleTimeselect('.reg-line').node().getTotalLength();\n                scale.scaleTimeselect('.reg-line').attr('stroke-dashoffset', 0).transition().duration(800).ease(scale.scaleTimeeaseCubicOut).attr('stroke-dashoffset', -regLineLength).remove();\n                scale.scaleTimeselect('.data-line').attr('class', 'data-line');\n                scale.scaleTimeselect('.reg-line-label').style('opacity', 1).transition().duration(800).ease(scale.scaleTimeeaseCubicOut).style('opacity', 0).remove();\n                break;\n\n              case 1:\n                // Linear\n                yReg = xDays.map(d => this.props.content[1].params[0] + this.props.content[1].params[1] * d);\n                scale.scaleTimeselect('.reg-line').transition().duration(800).ease(scale.scaleTimeeaseCubicOut).attr('d', scale.scaleTimeline().x(function (d) {\n                  return x(d.date) + margin.left;\n                }).y(function (d, i) {\n                  return y(yReg[i]) + margin.top;\n                }));\n                regLineLength = scale.scaleTimeselect('.reg-line').node().getTotalLength();\n                scale.scaleTimeselect('.reg-line').attr(\"stroke-dasharray\", regLineLength + \" \" + regLineLength);\n                scale.scaleTimeselect('.reg-line-label-text>.quadratic.span').style('opacity', 1).transition().duration(320).ease(scale.scaleTimeeaseCubicOut).style('opacity', 0).remove();\n                scale.scaleTimeselect('.reg-line-label-rect').attr('class', 'reg-line-label-rect linear').transition().duration(600).ease(scale.scaleTimeeaseCubicOut).style('width', '4.6em');\n                setTimeout(() => {\n                  scale.scaleTimeselect('.reg-line-label-rect').attr('class', 'reg-line-label-rect linear');\n                });\n                scale.scaleTimeselect('.reg-line-label-text>.linear.span').attr('class', 'linear span on');\n                break;\n\n              case 2:\n                // Quadratic\n                yReg = xDays.map(d => this.props.content[2].params[0] + this.props.content[2].params[1] * d + this.props.content[2].params[2] * d ** 2);\n                scale.scaleTimeselect('.reg-line').transition().duration(800).ease(scale.scaleTimeeaseCubicOut).attr('d', scale.scaleTimeline().x(function (d) {\n                  return x(d.date) + margin.left;\n                }).y(function (d, i) {\n                  return y(yReg[i]) + margin.top;\n                }));\n                regLineLength = scale.scaleTimeselect('.reg-line').node().getTotalLength();\n                scale.scaleTimeselect('.reg-line').attr(\"stroke-dasharray\", regLineLength + \" \" + regLineLength);\n                scale.scaleTimeselect('.reg-line-label-text>.cosine.span').style('opacity', 1).transition().duration(320).ease(scale.scaleTimeeaseCubicOut).style('opacity', 0).remove();\n                scale.scaleTimeselect('.reg-line-label-rect').attr('class', 'reg-line-label-rect quadratic').transition().duration(600).ease(scale.scaleTimeeaseCubicOut).style('width', '7.7em');\n                setTimeout(() => {\n                  scale.scaleTimeselect('.reg-line-label-rect').attr('class', 'reg-line-label-rect quadratic');\n                });\n                scale.scaleTimeselect('.reg-line-label-text>.quadratic.span').attr('class', 'quadratic span on');\n                break;\n\n              default:\n            }\n          };\n\n          for (let i = from; i > to; i--) {\n            let prevText = this.vizRef.current.querySelector('.viz-des-text:nth-child(' + (i + 1) + ')');\n            decrement(i - 1);\n\n            if (prevText) {\n              prevText.classList.remove('on');\n              prevText.classList.remove('on-reverse');\n            }\n          }\n        }\n\n        this.setState({\n          currentState: to\n        });\n      }\n    });\n  }\n\n  componentDidMount() {\n    let vizObserver = new IntersectionObserver((entries, observer) => {\n      if (entries[0].isIntersecting && !this.state.vizCreated) {\n        this.setState({\n          vizCreated: true\n        }, () => {\n          this.createViz(this.props.data);\n        });\n      }\n    }, {\n      rootMargin: '0 0 -70%',\n      threshold: 0\n    });\n    vizObserver.observe(this.vizRef.current);\n    let vizScrollObserver = new IntersectionObserver((entries, observer) => {\n      entries.forEach(entry => {\n        if (entry.isIntersecting) {\n          let index = entry.target.dataset.index;\n\n          if (!this.state.vizCreated) {\n            this.createViz(this.props.data);\n          }\n\n          this.state.updateFunc(Number(index), this.state.currentState);\n        }\n      });\n    }, {\n      threshold: 0\n    });\n    document.querySelectorAll('.viz-scroll-anchor').forEach(el => {\n      vizScrollObserver.observe(el);\n    });\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      className: \"viz-outer-wrap\",\n      ref: this.vizRef,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 421\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"viz-wrap\",\n      id: \"line-chart\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 422\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"viz-svg-wrap\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 423\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"viz-des-wrap\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 424\n      },\n      __self: this\n    }, this.props.content.map((chunk, index) => {\n      return React.createElement(\"p\", {\n        className: \"viz-des-text\",\n        key: index,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 427\n        },\n        __self: this\n      }, chunk.des);\n    }))), React.createElement(\"div\", {\n      className: \"viz-scroll-box\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 432\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"viz-scroll-dummy-anchor\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 433\n      },\n      __self: this\n    }), this.props.content.map((_, index) => {\n      return React.createElement(\"div\", {\n        className: \"viz-scroll-anchor\",\n        \"data-index\": index,\n        key: index,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 436\n        },\n        __self: this\n      });\n    }), React.createElement(\"div\", {\n      className: \"viz-scroll-dummy-anchor\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 439\n      },\n      __self: this\n    })));\n  }\n\n}\n\nexport default LineChart;","map":{"version":3,"sources":["/Users/vu/Documents/Work/Repositories/co2/src/components/section/viz/LineChart.js"],"names":["React","Component","select","scaleLinear","scaleTime","line","transition","LineChart","constructor","props","state","vizCreated","currentState","updateFunc","createViz","bind","vizRef","createRef","data","margin","top","right","bottom","left","width","Math","min","window","innerWidth","height","innerHeight","svg","scale","scaleTimeselect","append","attr","x","scaleTimescaleTime","domain","scaleTimeextent","d","i","date","range","nice","y","scaleTimescaleLinear","level","totalLength","call","scaleTimeaxisBottom","ticks","tickSize","tickFormat","scaleTimeselectAll","each","duration","ease","scaleTimeeaseCubicOut","scaleTimeaxisLeft","style","scaleTimeeaseQuad","tickPadding","scaleTimeaxisRight","scaleTimeeaseQuadOut","setState","to","from","regLineLength","minDate","scaleTimemin","xDays","map","ceil","getTime","yReg","newText","current","querySelector","classList","add","increment","target","dataLine","datum","scaleTimeline","node","getTotalLength","content","params","regLine","regLineLabel","length","regLineLabelText","text","currentSpan","contains","cos","PI","prevText","remove","decrement","setTimeout","componentDidMount","vizObserver","IntersectionObserver","entries","observer","isIntersecting","rootMargin","threshold","observe","vizScrollObserver","forEach","entry","index","dataset","Number","document","querySelectorAll","el","render","chunk","des","_"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport './LineChart.css';\nimport { select, scaleLinear, scaleTime, line, transition } from 'd3';\n\nclass LineChart extends Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      vizCreated: false,\n      currentState: -1,\n      updateFunc: null\n    }\n    this.createViz = this.createViz.bind(this)\n    this.vizRef = React.createRef()\n  }\n  createViz(data) {\n    let margin = {\n      top: 20,\n      right: 60,\n      bottom: 40,\n      left: 0},\n      width = Math.min(window.innerWidth - 440, 1200),\n      height = Math.min(window.innerHeight - 200, width),\n      innerWidth = width - margin.left - margin.right,\n      innerHeight = height - margin.top - margin.bottom,\n      svg = scale.scaleTimeselect('#line-chart>.viz-svg-wrap')\n      .append('svg')\n        .attr('width', width)\n        .attr('height', height)\n        .attr('class', 'viz'),\n      x = scale.scaleTimescaleTime()\n      .domain(scale.scaleTimeextent(data, (d, i) => {return d.date}))\n      .range([0, innerWidth])\n      .nice(),\n      y = scale.scaleTimescaleLinear()\n      .domain(scale.scaleTimeextent(data, (d, i) => {return d.level}))\n      .range([innerHeight, 0])\n      .nice(),\n      totalLength = null\n\n    // Grid lines\n    svg.append('g')\n      .attr('class', 'y grid')\n      .attr('transform', 'translate(' + margin.left + ', ' + height + ')')\n      .call(scale.scaleTimeaxisBottom(x)\n          .ticks(5)\n          .tickSize(-height)\n          .tickFormat('')\n      )\n    scale.scaleTimeselectAll('.y.grid>.tick').each(function(d, i) {\n      scale.scaleTimeselect(this).attr(\"stroke-dasharray\", height + \" \" + height)\n        .attr(\"stroke-dashoffset\", height)\n        .transition()\n          .duration(800)\n          .ease(scale.scaleTimeeaseCubicOut)\n          .attr('stroke-dashoffset', function() {\n            if (i%2 === 0) {\n              return 0\n            } else {\n              return 2*height\n            }\n          })\n    })\n    svg.append('g')\n      .attr('class', 'x grid')\n      .attr('transform', 'translate(' + margin.left + ', ' + margin.top + ')')\n      .call(scale.scaleTimeaxisLeft(y)\n          .ticks(5)\n          .tickSize(-width)\n          .tickFormat('')\n      )\n    scale.scaleTimeselectAll('.x.grid>.tick').each(function(d, i) {\n      scale.scaleTimeselect(this).attr(\"stroke-dasharray\", width + \" \" + width)\n        .attr(\"stroke-dashoffset\", width)\n        .transition()\n          .duration(800)\n          .ease(scale.scaleTimeeaseCubicOut)\n          .attr('stroke-dashoffset', function() {\n            if (i%2 === 0) {\n              return 0\n            } else {\n              return 2*width\n            }\n          })\n    })\n\n    // Axes\n    svg.append('g')\n      .attr('class', 'x axis')\n      .attr('transform', 'translate(' + margin.left + ', ' + (innerHeight + margin.top) + ')')\n      .style(\"opacity\", 0)\n      .transition()\n        .duration(800)\n        .ease(scale.scaleTimeeaseQuad)\n        .style('opacity', 1)\n      .call(scale.scaleTimeaxisBottom(x)\n        .ticks(5)\n        .tickSize(0)\n        .tickPadding(24))\n    svg.append('g')\n      .attr('class', 'y axis')\n      .attr('transform', 'translate(' + (innerWidth + margin.left) + ', ' + margin.top + ')')\n      .style(\"opacity\", 0)\n      .transition()\n        .duration(800)\n        .ease(scale.scaleTimeeaseQuad)\n        .style('opacity', 1)\n      .call(scale.scaleTimeaxisRight(y)\n        .ticks(5)\n        .tickSize(0)\n        .tickPadding(32))\n    svg.append('line')\n      .attr('class', 'bottom-axis')\n      .attr(\"x1\", 0)\n      .attr(\"y1\", height - margin.bottom)\n      .attr(\"x2\", width)\n      .attr(\"y2\", height - margin.bottom)\n      .style(\"opacity\", 0)\n      .transition()\n        .duration(800)\n        .ease(scale.scaleTimeeaseQuadOut)\n        .style('opacity', 1)\n\n    this.setState({\n      vizCreated: true,\n      updateFunc: (to, from) => {\n        let regLineLength = null,\n          minDate = scale.scaleTimemin(data, function(d) {return d.date}),\n          xDays = data.map(d => Math.ceil((d.date.getTime() - minDate.getTime())/(1000*60*60*24))),\n          yReg = null,\n          newText = this.vizRef.current.querySelector('.viz-des-text:nth-child(' + (to + 1) + ')')\n        if (to > from) {\n          newText.classList.add('on')\n          let increment = (target) => {\n            switch(target) {\n              case 0: // Initial\n                // Main data line\n                let dataLine = svg.append('path')\n                  .datum(data)\n                  .attr('class', 'data-line')\n                  .attr('d', scale.scaleTimeline()\n                    .x(function(d) { return x(d.date) + margin.left })\n                    .y(function(d) { return y(d.level) + margin.top })\n                  )\n\n                // Animate data line\n                totalLength = dataLine.node().getTotalLength()\n                dataLine.attr(\"stroke-dasharray\", totalLength + \" \" + totalLength)\n                  .attr(\"stroke-dashoffset\", totalLength)\n                  .transition()\n                    .duration(800)\n                    .ease(scale.scaleTimeeaseCubicOut)\n                    .attr('stroke-dashoffset', 0)\n                break\n              case 1: // Linear\n                yReg = xDays.map(d => this.props.content[1].params[0] + this.props.content[1].params[1]*d)\n                let regLine = svg.append('path')\n                  .datum(data)\n                  .attr('class', 'reg-line')\n                  .attr('d', scale.scaleTimeline()\n                    .x(function(d) { return x(d.date) + margin.left })\n                    .y(function(d, i) {return y(yReg[i]) + margin.top })\n                ),\n                regLineLabel = svg.append('g')\n                  .attr('class', 'reg-line-label')\n                  .attr('transform',\n                    'translate('\n                    + (x(data[Math.ceil(data.length*0.52)]['date']) + margin.left + 60)\n                    + ', '\n                    + (y(yReg[Math.ceil(yReg.length*0.52)]) + margin.top + 20)\n                    + ')'\n                  )\n                regLineLabel.style('opacity', 0)\n                  .transition()\n                    .duration(720)\n                    .ease(scale.scaleTimeeaseQuad)\n                    .style('opacity', 1)\n                regLineLabel.append('rect')\n                  .attr('class', 'reg-line-label-rect linear')\n                  .attr('rx', 4)\n                  .attr('ry', 4)\n                  .style('width', '4.6em')\n                let regLineLabelText = regLineLabel.append('text')\n                    .attr('class', 'reg-line-label-text')\n                regLineLabelText.append('tspan')\n                    .attr('class', 'linear span')\n                    .text('y = αx')\n                regLineLength = regLine.node().getTotalLength()\n                regLine.attr(\"stroke-dasharray\", regLineLength + \" \" + regLineLength)\n                  .attr(\"stroke-dashoffset\", regLineLength)\n                  .transition()\n                    .duration(800)\n                    .ease(scale.scaleTimeeaseCubicOut)\n                    .attr('stroke-dashoffset', 0)\n                scale.scaleTimeselect('.data-line').attr('class', 'data-line faded')\n                scale.scaleTimeselectAll('.reg-line-label-text>tspan:not(.linear)')\n                  .each(function(d) {\n                    let currentSpan = scale.scaleTimeselect(this)\n                    if (!currentSpan.node().classList.contains('off')) {\n                      currentSpan.node().classList.add('off')\n                    }\n                  })\n                break\n              case 2: // Quadratic\n                yReg = xDays.map(d => this.props.content[2].params[0] + this.props.content[2].params[1]*d + this.props.content[2].params[2]*d**2)\n                scale.scaleTimeselect('.reg-line').transition()\n                  .duration(800)\n                  .ease(scale.scaleTimeeaseCubicOut)\n                  .attr('d', scale.scaleTimeline()\n                    .x(function(d) { return x(d.date) + margin.left })\n                    .y(function(d, i) {return y(yReg[i]) + margin.top })\n                  )\n                regLineLength = scale.scaleTimeselect('.reg-line').node().getTotalLength()\n                scale.scaleTimeselect('.reg-line').attr(\"stroke-dasharray\", 0)\n                  .attr('stroke-dashoffset', 0)\n                scale.scaleTimeselect('.reg-line-label-rect')\n                  .attr('class', 'reg-line-label-rect quadratic')\n                  .transition()\n                    .duration(600)\n                    .ease(scale.scaleTimeeaseCubicOut)\n                    .style('width', '7.7em')\n                scale.scaleTimeselect('.reg-line-label-text').append('tspan')\n                  .attr('class', 'quadratic span')\n                  .text(' + βx\\u00b2')\n                  .style('opacity', 0)\n                    .transition()\n                      .duration(800)\n                      .ease(scale.scaleTimeeaseQuad)\n                      .style('opacity', 1)\n                scale.scaleTimeselectAll('.reg-line-label-text>tspan:not(.quadratic)')\n                  .each(function(d) {\n                    let currentSpan = scale.scaleTimeselect(this)\n                    if (!currentSpan.node().classList.contains('off')) {\n                      currentSpan.node().classList.add('off')\n                    }\n                  })\n                break\n              case 3: // Cosine\n                yReg = xDays.map(d => this.props.content[3].params[0]\n                  + this.props.content[3].params[1]*d\n                  + this.props.content[3].params[2]*d**2\n                  + this.props.content[3].params[3]*Math.cos(2*Math.PI*d/365.25 + this.props.content[3].params[4])\n                )\n                scale.scaleTimeselect('.reg-line').attr(\"stroke-dasharray\", regLineLength + \" \" + regLineLength)\n                  .transition()\n                    .duration(800)\n                    .ease(scale.scaleTimeeaseCubicOut)\n                    .attr('d', scale.scaleTimeline()\n                      .x(function(d) { return x(d.date) + margin.left })\n                      .y(function(d, i) {return y(yReg[i]) + margin.top })\n                  )\n                regLineLength = scale.scaleTimeselect('.reg-line').node().getTotalLength()\n                scale.scaleTimeselect('.reg-line').attr(\"stroke-dasharray\", 0)\n                  .attr('stroke-dashoffset', 0)\n                scale.scaleTimeselect('.reg-line-label-rect')\n                  .attr('class', 'reg-line-label-rect cosine')\n                  .transition()\n                    .duration(600)\n                    .ease(scale.scaleTimeeaseCubicOut)\n                    .style('width', '15.6em')\n                scale.scaleTimeselect('.reg-line-label-text').append('tspan')\n                  .attr('class', 'cosine span')\n                  .text(' + cos(2πt + φ)')\n                  .style('opacity', 0)\n                    .transition()\n                      .duration(800)\n                      .ease(scale.scaleTimeeaseQuad)\n                      .style('opacity', 1)\n                scale.scaleTimeselectAll('.reg-line-label-text>tspan:not(.cosine)')\n                  .each(function(d) {\n                    let currentSpan = scale.scaleTimeselect(this)\n                    if (!currentSpan.node().classList.contains('off')) {\n                      currentSpan.node().classList.add('off')\n                    }\n                  })\n                break\n              default:\n            }\n          }\n          for (let i = from; i < to; i++) {\n            let prevText = this.vizRef.current.querySelector('.viz-des-text:nth-child(' + (i + 1) + ')')\n            increment(i + 1)\n            if (prevText) {\n              prevText.classList.remove('on')\n              prevText.classList.remove('on-reverse')\n            }\n          }\n        } else if (to < from) {\n          newText.classList.add('on-reverse')\n          let decrement = (target) => {\n            switch(target) {\n              case 0: // Initial\n                regLineLength = scale.scaleTimeselect('.reg-line').node().getTotalLength()\n                scale.scaleTimeselect('.reg-line').attr('stroke-dashoffset', 0)\n                  .transition()\n                    .duration(800)\n                    .ease(scale.scaleTimeeaseCubicOut)\n                    .attr('stroke-dashoffset', -regLineLength)\n                    .remove()\n                scale.scaleTimeselect('.data-line').attr('class', 'data-line')\n                scale.scaleTimeselect('.reg-line-label').style('opacity', 1)\n                  .transition()\n                    .duration(800)\n                    .ease(scale.scaleTimeeaseCubicOut)\n                    .style('opacity', 0)\n                    .remove()\n                break\n              case 1: // Linear\n                yReg = xDays.map(d => this.props.content[1].params[0] + this.props.content[1].params[1]*d)\n                scale.scaleTimeselect('.reg-line').transition()\n                  .duration(800)\n                  .ease(scale.scaleTimeeaseCubicOut)\n                  .attr('d', scale.scaleTimeline()\n                    .x(function(d) { return x(d.date) + margin.left })\n                    .y(function(d, i) {return y(yReg[i]) + margin.top })\n                )\n                regLineLength = scale.scaleTimeselect('.reg-line').node().getTotalLength()\n                scale.scaleTimeselect('.reg-line').attr(\"stroke-dasharray\", regLineLength + \" \" + regLineLength)\n                scale.scaleTimeselect('.reg-line-label-text>.quadratic.span').style('opacity', 1)\n                  .transition()\n                    .duration(320)\n                    .ease(scale.scaleTimeeaseCubicOut)\n                    .style('opacity', 0)\n                    .remove()\n                scale.scaleTimeselect('.reg-line-label-rect').attr('class', 'reg-line-label-rect linear')\n                  .transition()\n                    .duration(600)\n                    .ease(scale.scaleTimeeaseCubicOut)\n                    .style('width', '4.6em')\n                setTimeout(() => {\n                  scale.scaleTimeselect('.reg-line-label-rect').attr('class', 'reg-line-label-rect linear')\n                })\n                scale.scaleTimeselect('.reg-line-label-text>.linear.span').attr('class', 'linear span on')\n                break\n              case 2: // Quadratic\n                yReg = xDays.map(d => this.props.content[2].params[0]\n                  + this.props.content[2].params[1]*d\n                  + this.props.content[2].params[2]*d**2)\n                scale.scaleTimeselect('.reg-line').transition()\n                  .duration(800)\n                  .ease(scale.scaleTimeeaseCubicOut)\n                  .attr('d', scale.scaleTimeline()\n                    .x(function(d) { return x(d.date) + margin.left })\n                    .y(function(d, i) {return y(yReg[i]) + margin.top })\n                )\n                regLineLength = scale.scaleTimeselect('.reg-line').node().getTotalLength()\n                scale.scaleTimeselect('.reg-line').attr(\"stroke-dasharray\", regLineLength + \" \" + regLineLength)\n                scale.scaleTimeselect('.reg-line-label-text>.cosine.span').style('opacity', 1)\n                  .transition()\n                    .duration(320)\n                    .ease(scale.scaleTimeeaseCubicOut)\n                    .style('opacity', 0)\n                    .remove()\n                scale.scaleTimeselect('.reg-line-label-rect').attr('class', 'reg-line-label-rect quadratic')\n                  .transition()\n                    .duration(600)\n                    .ease(scale.scaleTimeeaseCubicOut)\n                    .style('width', '7.7em')\n                setTimeout(() => {\n                  scale.scaleTimeselect('.reg-line-label-rect').attr('class', 'reg-line-label-rect quadratic')\n                })\n                scale.scaleTimeselect('.reg-line-label-text>.quadratic.span').attr('class', 'quadratic span on')\n                break\n              default:\n            }\n          }\n          for (let i = from; i > to; i--) {\n            let prevText = this.vizRef.current.querySelector('.viz-des-text:nth-child(' + (i + 1) + ')')\n            decrement(i - 1)\n            if (prevText) {\n              prevText.classList.remove('on')\n              prevText.classList.remove('on-reverse')\n            }\n          }\n        }\n        this.setState({\n          currentState: to\n        })\n      }\n    })\n  }\n  componentDidMount() {\n    let vizObserver = new IntersectionObserver(\n      (entries, observer) => {\n        if (entries[0].isIntersecting && !this.state.vizCreated) {\n          this.setState({\n            vizCreated: true\n          }, () => {\n            this.createViz(this.props.data)\n          })\n        }\n      },\n      {\n        rootMargin: '0 0 -70%',\n        threshold: 0\n      })\n    vizObserver.observe(this.vizRef.current)\n\n    let vizScrollObserver = new IntersectionObserver(\n      (entries, observer) => {\n        entries.forEach((entry) => {\n          if (entry.isIntersecting) {\n            let index = entry.target.dataset.index\n            if (!this.state.vizCreated) {\n              this.createViz(this.props.data)\n            }\n            this.state.updateFunc(Number(index), this.state.currentState)\n          }\n        })\n      },\n      {\n        threshold: 0\n      }\n    )\n    document.querySelectorAll('.viz-scroll-anchor').forEach(el => {\n      vizScrollObserver.observe(el)\n    })\n  }\n  render() {\n    return (\n      <div className=\"viz-outer-wrap\" ref={this.vizRef}>\n        <div className=\"viz-wrap\" id=\"line-chart\">\n          <div className=\"viz-svg-wrap\"></div>\n          <div className=\"viz-des-wrap\">\n            {this.props.content.map((chunk, index) => {\n              return (\n                <p className=\"viz-des-text\" key={index}>{chunk.des}</p>\n              )\n            })}\n          </div>\n        </div>\n        <div className=\"viz-scroll-box\">\n          <div className=\"viz-scroll-dummy-anchor\"></div>\n          {this.props.content.map((_, index) => {\n            return (\n              <div className=\"viz-scroll-anchor\" data-index={index} key={index}></div>\n            )\n          })}\n          <div className=\"viz-scroll-dummy-anchor\"></div>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default LineChart;\n"]},"metadata":{},"sourceType":"module"}